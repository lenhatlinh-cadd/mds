<h2>Bước 3: Thêm ion để trung hòa hệ thống</h2>

<p>Hiện tại, chúng ta đã có một hệ thống đã được hòa tan trong dung môi, nhưng protein mang điện tích dương tổng cộng là <b>+8e</b> (thông tin này được hiển thị trong kết quả của <code>pdb2gmx</code>). Nếu bạn bỏ sót, hãy xem dòng cuối trong mục <code>[ atoms ]</code> của file <code>topol.top</code>, sẽ có phần <code>qtot 8</code>. Vì trong thực tế sinh học không tồn tại hệ có điện tích tổng, nên chúng ta cần bổ sung ion để trung hòa.</p>

<p>Công cụ trong GROMACS dùng để thêm ion là <b>genion</b>. Lệnh này sẽ thay thế một số phân tử nước bằng ion mà ta chỉ định. Đầu vào của <code>genion</code> là file chạy (run input file) có phần mở rộng <code>.tpr</code>. File này được tạo bởi <code>grompp</code> (GROMACS pre-processor), công cụ kết hợp tọa độ, topology và thông số từ file tham số động lực học phân tử (<code>.mdp</code>) để sinh ra mô tả chi tiết ở mức nguyên tử.</p>

<p>Ở bước này, chúng ta chỉ cần một file <code>.mdp</code> đơn giản để sinh ra <code>.tpr</code>. Thông thường, người ta dùng file <code>.mdp</code> cho tối ưu năng lượng, vì nó cơ bản và không chứa tham số phức tạp. Lưu ý rằng file trong hướng dẫn này chỉ tương thích với trường lực CHARMM36.</p>

<h3>Tạo file .tpr bằng grompp:</h3>

<div class="code-block">
<pre>
gmx grompp -f inputs/ions.mdp -c 1AKI_solv.gro -p topol.top -o ions.tpr
</pre>
</div>

<p>Lệnh trên tạo ra file <code>ions.tpr</code> – mô tả đầy đủ hệ thống ở mức nguyên tử.</p>

<h3>Thêm ion bằng genion:</h3>

<div class="code-block">
<pre>
gmx genion -s ions.tpr -o 1AKI_solv_ions.gro -p topol.top -pname NA -nname CL -neutral
</pre>
</div>

<p>Khi chạy, chương trình sẽ yêu cầu chọn nhóm để chèn ion. Hãy chọn nhóm <b>13 "SOL"</b>, tức là thay ion vào chỗ phân tử nước, không thay thế vào protein.</p>

<p>Trong lệnh trên:</p>
<ul>
  <li><code>-s ions.tpr</code>: file đầu vào (trạng thái hệ thống)</li>
  <li><code>-o 1AKI_solv_ions.gro</code>: file đầu ra chứa protein, nước và ion</li>
  <li><code>-p topol.top</code>: cập nhật topology, phản ánh việc thay nước bằng ion</li>
  <li><code>-pname NA</code>: tên ion dương</li>
  <li><code>-nname CL</code>: tên ion âm</li>
  <li><code>-neutral</code>: thêm ion chỉ để trung hòa điện tích tổng</li>
</ul>

<p>Trong ví dụ này, GROMACS sẽ thêm <b>8 ion Cl-</b> để cân bằng điện tích dương +8 của protein.</p>

<p>Lưu ý:</p>
<ul>
  <li>Bạn cũng có thể thêm nồng độ muối cụ thể bằng cách kết hợp <code>-neutral</code> và <code>-conc</code>.</li>
  <li>Từ phiên bản 4.5, tên ion luôn được chuẩn hóa thành ký hiệu nguyên tố viết hoa (ví dụ: <code>NA</code>, <code>CL</code>), thay vì tên residue hoặc atom.</li>
</ul>

<h3>Kết quả sau khi thêm ion:</h3>

<div class="code-block">
<pre>
[molecules] 
; Compound        #mols
Protein_chain_A     1  
SOL             12588  
CL                  8
</pre>
</div>

<p>Bây giờ, hệ thống của bạn đã được trung hòa và sẵn sàng cho bước tiếp theo.</p>
