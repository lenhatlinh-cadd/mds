<h2>KIỂM TRA TỆP CẤU TRÚC LIÊN KẾT</h2>

<p>Sau khi chạy <code>pdb2gmx</code>, chúng ta thu được file topology <code>topol.top</code>.  
Hãy mở file này bằng trình soạn thảo văn bản để quan sát nội dung. Sau một vài dòng chú thích (bắt đầu bằng <code>;</code>), bạn sẽ thấy dòng sau:</p>

<div class="code-view">
<pre>
#include "charmm36.ff/forcefield.itp"
</pre>
</div>

<p>Dòng này cho biết file đang sử dụng bộ tham số từ trường lực <b>CHARMM36</b>. Nó nằm ở đầu file, nghĩa là toàn bộ tham số tiếp theo đều dựa trên trường lực này.</p>

<h3>Moleculetype</h3>

<p>Ngay sau đó là phần <code>[ moleculetype ]</code>:</p>

<div class="code-view">
<pre>
; Name            nrexcl
Protein_chain_A     3
</pre>
</div>

<p>Ở đây, <code>Protein_chain_A</code> là tên phân tử, dựa theo nhãn "chain A" trong file PDB gốc.  
Số <code>3</code> biểu thị số lượng ngoại lệ (exclusions) cho các nguyên tử liên kết gần nhau.  
Chi tiết hơn về "exclusions" có thể tham khảo trong tài liệu hướng dẫn GROMACS.</p>

<h3>Atoms</h3>

<p>Tiếp theo là phần <code>[ atoms ]</code>, mô tả chi tiết từng nguyên tử trong protein:</p>

<div class="code-view">
<pre>
[ atoms ]
;   nr   type  resnr residue  atom   cgnr  charge   mass
; residue   1 LYS rtp LYS  q +2.0
     1    NH3     1    LYS      N      1   -0.3   14.007
     2     HC     1    LYS     H1      2    0.33   1.008
     3     HC     1    LYS     H2      3    0.33   1.008
     4     HC     1    LYS     H3      4    0.33   1.008
     5    CT1     1    LYS     CA      5    0.21  12.011
     6    HB1     1    LYS     HA      6    0.1    1.008
</pre>
</div>

<p>Ý nghĩa của các cột:</p>
<ul>
  <li><b>nr</b>: Số thứ tự nguyên tử (mỗi <code>moleculetype</code> bắt đầu từ 1).</li>
  <li><b>type</b>: Kiểu nguyên tử, quyết định tham số Lennard-Jones.</li>
  <li><b>resnr</b>: Số thứ tự amino acid.</li>
  <li><b>residue</b>: Tên amino acid (ở đây là <code>LYS</code>, tức lysine đã được proton hóa theo quy ước CHARMM ở pH trung tính; nếu là dạng trung hòa sẽ ghi <code>LSN</code>).</li>
  <li><b>atom</b>: Tên nguyên tử.</li>
  <li><b>cgnr</b>: Số nhóm điện tích (charge group) – khái niệm cũ, ít còn quan trọng hiện nay.</li>
  <li><b>charge</b>: Điện tích riêng phần của nguyên tử.</li>
  <li><b>mass</b>: Khối lượng nguyên tử.</li>
  <li><b>typeB, chargeB, massB</b>: Dùng trong tính toán biến đổi năng lượng tự do (FEP), không bàn chi tiết ở đây.</li>
</ul>

<p>Các phần tiếp theo của file lần lượt là <code>[ bonds ]</code>, <code>[ pairs ]</code>, <code>[ angles ]</code>, và <code>[ dihedrals ]</code> để định nghĩa liên kết, góc, và mômen xoay.  
Thông tin chi tiết hơn có trong Chương 5 của GROMACS manual.</p>

<h3>Ràng buộc vị trí (Position restraints)</h3>

<p>File <code>posre.itp</code> được sinh ra bởi <code>pdb2gmx</code>, dùng để giữ các nguyên tử cố định trong giai đoạn cân bằng:</p>

<div class="code-view">
<pre>
; Include Position restraint file
#ifdef POSRES
#include "posre.itp"
#endif
</pre>
</div>

<h3>Mô hình nước</h3>

<p>Tiếp theo, topology bổ sung phân tử dung môi. Ở đây là <b>TIP3P water</b>, do ta đã chọn tùy chọn <code>-water tip3p</code> khi chạy <code>pdb2gmx</code>:</p>

<div class="code-view">
<pre>
; Include water topology
#include "charmm36.ff/tip3p.itp"
</pre>
</div>

<p>Nước cũng có thể được ràng buộc vị trí (position restraints):</p>

<div class="code-view">
<pre>
#ifdef POSRES_WATER
[ position_restraints ]
;  i funct   fcx   fcy   fcz
   1    1   1000  1000  1000
#endif
</pre>
</div>

<h3>Ion</h3>

<p>Sau nước là tham số cho các ion:</p>

<div class="code-view">
<pre>
; Include generic topology for ions
#include "charmm36.ff/ions.itp"
</pre>
</div>

<h3>Định nghĩa hệ thống</h3>

<p>Phần cuối cùng của topology định nghĩa hệ thống:</p>

<div class="code-view">
<pre>
[ system ]
; Name
LYSOZYME

[ molecules ]
; Compound        #mols
Protein_chain_A     1
</pre>
</div>

<ul>
  <li>Thứ tự các phân tử ở đây phải <b>trùng khớp</b> với thứ tự trong file tọa độ (.gro).</li>
  <li>Tên phân tử phải đúng với tên trong <code>[ moleculetype ]</code>.</li>
  <li>Nếu sai tên hoặc số lượng, lệnh <code>grompp</code> sẽ báo lỗi nghiêm trọng.</li>
</ul>
