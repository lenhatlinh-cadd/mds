<h2>Step 8: Phân tích quỹ đạo – Hiệu chỉnh tính tuần hoàn & RMSD</h2>

<p>Sau khi đã chạy mô phỏng MD, bước tiếp theo là tiến hành <b>phân tích dữ liệu</b>. 
Trước khi bắt đầu, bạn cần tự đặt câu hỏi: “Mình muốn thu được những loại dữ liệu gì từ mô phỏng này?”.
Trong ví dụ này, chúng ta sẽ giới thiệu một số công cụ cơ bản của GROMACS để xử lý và phân tích quỹ đạo.</p>

<h3>Hiệu chỉnh tính tuần hoàn (Periodicity)</h3>
<p>Trong quá trình mô phỏng, protein có thể khuếch tán trong hộp mô phỏng (unit cell), đôi khi trông như bị "gãy" hoặc "nhảy" sang phía bên kia của hộp do <b>điều kiện biên tuần hoàn</b>. 
Để khắc phục, ta dùng công cụ <code>trjconv</code>:</p>

<div class="code">
<pre>
gmx trjconv -s md_0_10.tpr -f md_0_10.xtc -o md_0_10_noPBC.xtc -pbc mol -center
</pre>
</div>

<p>Tại các lựa chọn, chọn <b>1 ("Protein")</b> để làm trung tâm và <b>0 ("System")</b> cho đầu ra.
Tất cả các phân tích sau sẽ được thực hiện trên quỹ đạo đã hiệu chỉnh này (<code>md_0_10_noPBC.xtc</code>).</p>

<h3>Độ lệch bình phương trung bình (RMSD)</h3>
<p>Công cụ <code>gmx rms</code> được dùng để tính RMSD, giúp đánh giá độ lệch cấu trúc theo thời gian:</p>

<div class="code">
<pre>
gmx rms -s md_0_10.tpr -f md_0_10_noPBC.xtc -o rmsd.xvg -tu ns
</pre>
</div>

<p>Chọn <b>4 ("Backbone")</b> cho cả bước fit least-squares và nhóm tính RMSD.
Tùy chọn <code>-tu ns</code> chuyển đơn vị thời gian từ ps sang ns cho dễ đọc. 
Kết quả là biểu đồ RMSD so với cấu trúc protein đã được tối ưu năng lượng và cân bằng.</p>

<p>Nếu muốn tính RMSD so với <b>cấu trúc tinh thể gốc (crystal structure)</b>, dùng lệnh sau:</p>

<div class="code">
<pre>
gmx rms -s em.tpr -f md_0_10_noPBC.xtc -o rmsd_xtal.xvg -tu ns
</pre>
</div>

<h3>Đọc kết quả</h3>
<p>Khi vẽ RMSD từ hai cách trên, ta thấy giá trị dao động quanh <b>0.09 ± 0.01 nm (≈ 0.9 Å)</b>, chứng tỏ cấu trúc protein không thay đổi nhiều sau khi mô phỏng. 
Sự khác biệt nhỏ giữa hai đường cong là do sự khác biệt giữa cấu trúc đã tối ưu hóa và cấu trúc tinh thể gốc – điều này là bình thường.</p>

<p>Lưu ý: RMSD <b>không thể</b> dùng làm thước đo duy nhất để đánh giá tính ổn định hay hội tụ của mô phỏng. Một phức hợp protein lớn có thể có RMSD ≈ 1.0 nm (gấp 10 lần ví dụ này) nhưng vẫn ổn định, vì RMSD chỉ phản ánh sự tích lũy của các dịch chuyển nhỏ.</p>
