<h2>Step 9: Phân tích nâng cao – Độ gọn (Rg), cấu trúc bậc hai & liên kết hydro</h2>

<h3>Độ gọn của protein (Radius of Gyration – Rg)</h3>
<p><b>Radius of gyration (Rg)</b> cho biết mức độ “gọn” của protein. 
Nếu protein ổn định ở trạng thái gấp nếp, giá trị Rg sẽ dao động quanh một giá trị cố định. 
Nếu protein bị duỗi ra hoặc sụp đổ, Rg sẽ thay đổi theo thời gian.</p>

<div class="code-block">
<pre>
gmx gyrate -s md_0_10.tpr -f md_0_10_noPBC.xtc -o gyrate.xvg -sel Protein -tu ns
</pre>
</div>

<p>Trong ví dụ với lysozyme, giá trị Rg ổn định quanh <b>1.409 ± 0.008 nm</b>, cho thấy protein duy trì trạng thái gấp nếp trong suốt 10 ns ở 298 K. 
Kết quả này là hợp lý và minh họa cho khả năng phân tích nâng cao có sẵn trong GROMACS. 
Tương tự RMSD, dữ liệu có thể được làm mượt bằng cửa sổ trượt 500 ps trong XmGrace.</p>

<h3>Cấu trúc bậc hai (Secondary Structure)</h3>
<p>Cấu trúc bậc hai của protein (α-helix, β-sheet, coil, …) phản ánh sự bền vững của cấu trúc trong quá trình mô phỏng. 
GROMACS tích hợp thuật toán <b>DSSP (Dictionary of Secondary Structure of Proteins)</b> thông qua lệnh <code>gmx dssp</code> để phân tích:</p>

<div class="code-block">
<pre>
gmx dssp -s md_0_10.tpr -f md_0_10_noPBC.xtc -tu ns -o dssp.dat -num dssp_num.xvg
</pre>
</div>

<p>Kết quả đầu ra có thể cần chỉnh lại nhãn (label) và sắp xếp dữ liệu. 
Sau khi xử lý, bạn sẽ thu được biểu đồ thể hiện sự thay đổi tỉ lệ các loại cấu trúc bậc hai theo thời gian. 
Để quan sát rõ hơn, dữ liệu có thể được làm mượt với trung bình trượt 500 ps.</p>

<h3>Liên kết hydro (Hydrogen Bonds)</h3>
<p>Liên kết hydro trong GROMACS được xác định dựa trên 2 tiêu chí:</p>
<ul>
  <li>Khoảng cách donor–H ≤ 0.35 nm (có thể chỉnh với <code>-hbr</code>)</li>
  <li>Góc donor–acceptor–H ≤ 30° (tương ứng góc H–donor–acceptor trong khoảng 150°–180°)</li>
</ul>
<p>Công cụ sử dụng là <code>gmx hbond</code>. Khi chạy, chương trình sẽ yêu cầu chọn 2 nhóm để kiểm tra. 
Các nhóm này phải hoặc giống hệt nhau, hoặc hoàn toàn tách biệt (không có nguyên tử chung).</p>

<p><b>(a) Liên kết hydro trong khung chính (main chain)</b></p>
<div class="code-block">
<pre>
gmx hbond -s md_0_10.tpr -f md_0_10_noPBC.xtc -tu ns -num hbnum_mainchain.xvg
</pre>
</div>
<p>Chọn nhóm <b>MainChain+H</b> (7) cho cả hai lựa chọn. 
Lưu ý: nhóm “Backbone” trong GROMACS chỉ có N, Cα, C → không dùng được cho phân tích H-bond.</p>

<p><b>(b) Liên kết hydro giữa các mạch bên (side chain)</b></p>
<div class="code-block">
<pre>
gmx hbond -s md_0_10.tpr -f md_0_10_noPBC.xtc -tu ns -num hbnum_sidechain.xvg
</pre>
</div>
<p>Chọn nhóm <b>SideChain</b> (8) cho cả hai lựa chọn.</p>

<p><b>(c) Liên kết hydro giữa protein và nước</b></p>
<div class="code-block">
<pre>
gmx hbond -s md_0_10.tpr -f md_0_10_noPBC.xtc -tu ns -num hbnum_prot_wat.xvg
</pre>
</div>
<p>Chọn <b>Protein</b> (1) và <b>Water (12)</b> hoặc <b>SOL (13)</b> (hai nhóm này tương đương).</p>

<h3>Đọc kết quả</h3>
<p>Khi vẽ biểu đồ, bạn sẽ thấy:</p>
<ul>
  <li>Số lượng H-bond trong khung chính (MainChain+H) khá ổn định, khoảng 55 liên kết.</li>
  <li>Mạch bên (SideChain) ít hơn, khoảng ~20 liên kết.</li>
  <li>Protein hình thành nhiều H-bond với phân tử nước, phản ánh sự hòa tan tốt.</li>
</ul>
<p>Tất cả kết quả đều ổn định theo thời gian, điều này phù hợp với một mô phỏng ngắn (10 ns).</p>
