<h2>TIẾN HÀNH MÔ PHỎNG</h2>

<p>Sau khi hoàn tất hai giai đoạn cân bằng (NVT và NPT), hệ thống đã ổn định ở nhiệt độ và áp suất mong muốn. Giờ đây chúng ta có thể <b>gỡ bỏ ràng buộc vị trí</b> và tiến hành mô phỏng động lực học phân tử (MD) để thu thập dữ liệu thực tế.</p>

<p>Cách thực hiện tương tự như các bước trước: chúng ta sẽ dùng file checkpoint (lúc này đã lưu cả thông tin về áp suất) để chạy <code>grompp</code>. Trong ví dụ này, ta sẽ chạy mô phỏng MD trong <b>10 ns</b>:</p>

<div class="code">
<pre>
gmx grompp -f inputs/md.mdp -c npt.gro -t npt.cpt -p topol.top -o md_0_10.tpr

gmx mdrun -deffnm md_0_10
</pre>
</div>

<h3>Tăng tốc bằng GPU</h3>
<p>Kể từ phiên bản GROMACS 2025, các tính toán PME có thể được xử lý trên GPU, giúp mô phỏng nhanh hơn rất nhiều. Ví dụ, với card Titan Xp, tốc độ có thể đạt tới <b>196 ns/ngày</b> cho hệ thống này!</p>

<p>Trên thực tế, từ phiên bản 4.6, GROMACS đã hỗ trợ GPU cho mô phỏng MD. Đến phiên bản 2018, hầu hết các tương tác không liên kết (nonbonded) và tính toán PME đều chạy trên GPU, trong khi các lực liên kết (bonded forces) vẫn do CPU xử lý. Khi cài đặt GROMACS (xem hướng dẫn tại <a href="https://www.gromacs.org" target="_blank">www.gromacs.org</a>), chương trình sẽ tự động nhận diện GPU nếu có sẵn. Điều kiện tối thiểu để sử dụng GPU tăng tốc là có thư viện CUDA, SDK và GPU với compute capability ≥ 2.0.</p>

<p>Nếu bạn có nhiều GPU hoặc muốn tùy chỉnh cách phân chia công việc trong sơ đồ song song lai (hybrid parallelization), hãy tham khảo chi tiết trong <i>GROMACS manual</i> và trang chủ GROMACS. Những chi tiết kỹ thuật nâng cao này nằm ngoài phạm vi của hướng dẫn hiện tại.</p>
