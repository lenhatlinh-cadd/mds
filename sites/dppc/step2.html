<h2 style="text-transform: uppercase;">
  Tham số lipid DPPC và tích hợp vào force field
</h2>

<p>Hệ lipid mà chúng ta sẽ mô phỏng là <b>DPPC</b> (dipalmitoylphosphatidylcholine), 
do đó cần chuẩn bị tham số cho phân tử này. 
Vì <code>pdb2gmx</code> chỉ hỗ trợ protein, acid nucleic và một số cofactor, 
chúng ta cần bổ sung tham số lipid từ nguồn bên ngoài.</p>

<p>Trong hướng dẫn này, chúng ta sẽ dùng <b>united-atom force field</b> cho lipid, được phát triển bởi 
<i>Berger, Edholm và Jähnig</i>. Các tham số này có thể kết hợp với protein mô tả bằng GROMOS.</p>

<div class="note">
  "Berger lipids" là sự lai giữa kiểu nguyên tử GROMOS và điện tích OPLS. 
  Chuỗi alkane dài vốn được mô tả kém trong GROMOS nên dùng thế năng xoay <i>Ryckaert-Bellemans</i>, 
  cùng với hệ số 0.125 áp dụng cho tương tác Lennard-Jones 1-4. 
</div>

<p>Bạn có thể tải bộ tham số lipid từ website của <b>D. Peter Tieleman</b>. 
Cần các file:</p>
<ul>
  <li><code>dppc128.pdb</code> - cấu trúc bilayer DPPC gồm 128 lipid</li>
  <li><code>dppc.itp</code> - định nghĩa <code>[ moleculetype ]</code> cho DPPC</li>
  <li><code>lipid.itp</code> - tham số Berger lipid</li>
</ul>

<h3>lipid.itp là gì?</h3>
<p>Hãy coi <code>lipid.itp</code> như <code>forcefield.itp</code> của protein: 
nó chứa toàn bộ <b>atom types</b>, tham số tương tác không liên kết và có liên kết của lipid. 
Vì thế không thể đơn giản <code>#include "lipid.itp"</code> trong topology, 
mà cần chỉnh sửa force field sẵn có.</p>

<h3>Tạo force field mở rộng</h3>
<p>Sao chép thư mục force field GROMOS96 53A6 thành bản mới để chỉnh sửa:</p>

<div class="code">
  <pre>cp -r /usr/local/gromacs/share/gromacs/top/gromos53a6.ff/ ./gromos53a6_lipid.ff</pre>
</div>

<p>Bên trong <code>gromos53a6_lipid.ff</code> có các file chính:</p>
<ul>
  <li><b>aminoacids.*</b> - dữ liệu residue, patching và hydro cho pdb2gmx</li>
  <li><b>atomtypes.atp</b> - danh sách atom type</li>
  <li><b>ffbonded.itp</b> - tham số liên kết</li>
  <li><b>ffnonbonded.itp</b> - tham số không liên kết (LJ)</li>
  <li><b>ions.itp</b> - topology ion đơn nguyên tử</li>
  <li><b>spc.itp, spce.itp, tip3p.itp, tip4p.itp</b> - mô hình nước</li>
  <li><b>watermodels.dat</b> - file chọn mô hình nước</li>
</ul>

<p>Sửa file <code>forcefield.doc</code> để phản ánh thay đổi, ví dụ:</p>
<pre><code>GROMOS96 53A6 force field, extended to include Berger lipid parameters
</code></pre>

<h3>Các thay đổi cần thực hiện</h3>
<ul>
  <li>Copy <code>[atomtypes]</code> từ <code>lipid.itp</code> sang <code>ffnonbonded.itp</code> và thêm cột số nguyên tử.</li>
  <li>Copy <code>[nonbond_params]</code> từ <code>lipid.itp</code> sang <code>ffnonbonded.itp</code>.</li>
  <li>Xóa các dòng <code>;; parameters for lipid-GROMOS interactions</code> và phần bên dưới (tránh lỗi với ffgmx).</li>
  <li>Xóa hoặc đổi tên các dòng chứa "HW" thành "H".</li>
  <li>Copy <code>[pairtypes]</code> từ <code>lipid.itp</code> sang <code>ffnonbonded.itp</code>.</li>
  <li>Copy <code>[dihedraltypes]</code> từ <code>lipid.itp</code> sang <code>ffbonded.itp</code> 
      (chúng là Ryckaert-Bellemans dihedrals, khác với chuẩn GROMOS).</li>
</ul>

<p>Cuối cùng, thay lệnh include trong <code>topol.top</code> từ:</p>
<pre><code>#include "gromos53a6.ff/forcefield.itp"
</code></pre>
<p>thành:</p>
<div class="code"><code>#include "gromos53a6_lipid.ff/forcefield.itp"
</code></div>

<h3>Thêm topology DPPC</h3>
<p>Thêm dòng <div class = "code">#include "dppc.itp"</div> vào <code>topol.top</code>, 
ngay sau phần protein <code>[ moleculetype ]</code> (sau posre.itp):</p>

<div class="code-view"><code>; Include Position restraint file
#ifdef POSRES
#include "posre.itp"
#endif

; Include DPPC chain topology
#include "dppc.itp"

; Include water topology
#include "gromos53a6_lipid.ff/spc.itp"
</code></div>

<h3>Ghi chú về force field</h3>
<p>Vì tham số Berger kết hợp từ GROMOS và OPLS-UA, có thể dùng OPLS-AA cho protein 
và vẫn tương thích. Khi đó cần chỉnh <code>lipid.itp</code> cho đúng chuẩn OPLS. 
Xem thêm:</p>
<ul>
  <li><a href="https://mailman-1.sys.kth.se/pipermail/gromacs.org_gmx-users/2006-May/021416.html">Thảo luận 1</a></li>
  <li><a href="https://mailman-1.sys.kth.se/pipermail/gromacs.org_gmx-users/2006-August/023587.html">Thảo luận 2</a></li>
  <li><a href="https://mailman-1.sys.kth.se/pipermail/gromacs.org_gmx-users/2006-September/023761.html">Thảo luận 3</a></li>
</ul>

<p>Bất kể lựa chọn nào, bạn phải chứng minh mô hình là hợp lý. 
Ví dụ, GROMOS96 53A6 có xu hướng làm α-helix kém ổn định → có thể cần 54A7 hoặc force field khác. 
Nếu làm đúng các bước trên, bạn sẽ có force field hoàn chỉnh để xử lý protein màng bằng <code>pdb2gmx</code> 
mà không cần chỉnh sửa thủ công <code>topol.top</code> sau này. 
Đặt thư mục <code>gromos53a6_lipid.ff</code> vào <code>$GMXLIB</code> 
để sử dụng toàn hệ thống.</p>
