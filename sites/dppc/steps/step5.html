<h2 style="text-transform: uppercase;">
  Tối ưu năng lượng hệ thống
</h2>

<p>Bước này tương tự như bất kỳ mô phỏng GROMACS nào. Trước hết, ta tạo file nhị phân đầu vào (.tpr) bằng <code>grompp</code> với file tham số:</p>

<pre><code>gmx grompp -f minim.mdp -c system_solv_ions.gro -p topol.top -o em.tpr
</code></pre>

<p>Sau đó, thực hiện chạy mô phỏng năng lượng tối thiểu bằng <code>mdrun</code>:</p>

<pre><code>gmx mdrun -v -deffnm em
</code></pre>

<p>Như mọi mô phỏng khác, hãy kiểm tra các giá trị của <code>Epot</code> và <code>Fmax</code> để đảm bảo chúng hợp lý trước khi tiếp tục. 
Các hệ thống protein màng có thể gặp một số vấn đề đặc thù. Nếu hệ thống không hội tụ, hãy xem xét các yếu tố sau:</p>

<ul>
  <li><b>Hydrogen bonding trong đầu lipid</b> (như PE hoặc PG): đầu nhóm đôi khi gập vào nhau trong các khoảng trống của dung môi. Giải pháp:
    <ul>
      <li>Sử dụng position restraints hoặc freeze groups trong quá trình cân bằng cho đến khi dung môi ổn định xung quanh đầu lipid.</li>
      <li>Giảm điện tích của các nguyên tử H (có thể về 0 nếu cần) và khôi phục trước khi tiếp tục.</li>
      <li>Thêm <code>[exclusions]</code> trong topology giữa H và O phosphate; xóa exclusions trước khi tiếp tục.</li>
    </ul>
  </li>
  <li><b>Chồng chéo chuỗi acyl</b>: thực hiện InflateGRO cẩn thận, không cố nhồi nhét quá nhiều lipid.</li>
  <li><b>Chồng chéo protein-lipid</b>: kiểm tra giá trị cut-off ban đầu trong InflateGRO.</li>
  <li><b>Chồng chéo nước-đầu nhóm và ion-đầu nhóm</b>: genbox/genion đôi khi đặt ion ngẫu nhiên, có thể khiến CL- gần phosphate làm di chuyển ion hoặc lipid trong hộp mô phỏng.</li>
</ul>

<p>Khi hệ thống đã đạt đến năng lượng tối thiểu, chúng ta có thể bắt đầu bước <b>mô phỏng động lực học thực sự</b>.</p>
